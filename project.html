<!doctype html>
<html lang="en">
<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

  <title>Hello, world!</title>
</head>

<body>
<style>
  *{
    margin:0;
    padding:0;
  }
  .header{
    width : 100vw;
    position: fixed;
    z-index: 1000;
  }
.container-fluid{
  padding-top: 10vh;
  display: flex;
}


/*coffee flatccino dessert*/
</style>
<div class="header">
  <nav class=" navbar navbar-expand-lg navbar-fixed-top navbar-light bg-light">
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarTogglerDemo01" aria-controls="navbarTogglerDemo01" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarTogglerDemo01">
      <a class="navbar-brand" href="#">
        <img src="https://mblogthumb-phinf.pstatic.net/MjAyMDAxMTlfMTQw/MDAxNTc5NDAwMDg5NTE2.S9GKzIplZxZ-ORqiRgplWNMHthkLAN8Of1DnnzydWZAg.0vvoUBvvF8AdVSYoVTBOWxO-SypGcCQRN3vfBBgdswog.JPEG.skysde/%25EC%259D%25B4%25EB%2594%2594%25EC%2595%25BC%25EC%25BB%25A4%25ED%2594%25BC1.jpg?type=w800" width="50" height="50" alt="">
      </a>
      <a class="navbar-brand" href="project.html">EDIYA COFFEE</a>
      <ul class="navbar-nav mr-auto mt-2 mt-lg-0">
        <li class="nav-item active">
          <a class="nav-link" href=""> coffee <span class="sr-only"></span></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#2"> flatccino </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#3"> dessert </a>
        </li>
      </ul>
    </div>
    <form class="form-inline my-2 my-lg-0" style="display: flex">
      <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search">
      <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
    </form>
  </nav>
</div>
</div>
<div class="container-fluid">
  <div class = "main col-md-8">
    <div id = "1">
      <nav class="navbar navbar-expand-lg navbar-light">
        <a class="navbar-brand">Coffee</a>
      </nav>
      <div class="coffee row row-cols-1 row-cols-md-3 g-4">

      </div>
    </div>
    <div id="2">
      <nav class="navbar navbar-expand-lg navbar-light">
        <a class="navbar-brand">flatccino</a>
      </nav>
      <div class="flatccino row row-cols-1 row-cols-md-3 g-4">

      </div>
    </div>
    <div id="3">
      <nav class="navbar navbar-expand-lg navbar-light">
        <a class="navbar-brand">dessert</a>
      </nav>
      <div class="dessert row row-cols-1 row-cols-md-3 g-4">

      </div>
    </div>
  </div>
  <!--결제 창-->
  <div class="card col-sm-1 col-md-4" style="margin-top:7vh;">
    <div class ="orderlist card-body">
      <h1 class="card-title">ORDER LIST</h1>
      <h6 class="card-subtitle mb-2 text-muted">주문 페이지입니다.</h6>
      <p class="card-text">Some quick example text to build on the card title and make up the bulk of the card's content.</p>
      <a href="#" class="card-link">TAKE-OUT</a>
      <a href="#" class="card-link">Another link</a>
    </div>
  </div>

</div>
<!-- Optional JavaScript; choose one of the two! -->

<!-- Option 1: Bootstrap Bundle with Popper -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>

<!-- Option 2: Separate Popper and Bootstrap JS -->
<!--
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js" integrity="sha384-7+zCNj/IqJ95wo16oMtfsKbZ9ccEh31eOz1HGyDuCQ6wgnyJNSYdrPa03rtR1zdB" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js" integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13" crossorigin="anonymous"></script>
-->
<script>

  let orders = []
  const menus_coffee = [
    {name:'Espresso', price:2900, picture:'menu/c1.jpg'},
    {name:'Espresso Con Panna', price:3200, picture:'menu/c2.jpg'},
    {name:'(Ice) Caffe Americano', price:3200, picture:'menu/c3.jpg'},
    {name:'(Hot) Caffe Americano', price:3200, picture:'menu/c4.jpg'},
    {name:'(Ice) Caffe Latte', price:3200, picture:'menu/c5.jpg'},
    {name:'(Hot) Caffe Latte', price:3200, picture:'menu/c6.jpg'},
    {name:'(Ice) Cappuccino', price:3700, picture:'menu/c7.jpg'},
    {name:'(Hot) Cappuccino', price:3700, picture:'menu/c8.jpg'},
    {name:'(Ice) Caffe Mocha', price:3900, picture:'menu/c9.jpg'},
    {name:'(Hot) Caffe Mocha', price:3900, picture:'menu/c10.jpg'},
    {name:'(Ice) Caramel Macchiato', price:3900, picture:'menu/c11.jpg'},
    {name:'(Hot) Caramel Macchiato', price:3900, picture:'menu/c12.jpg'},
  ]
  const menus_flatccino = [
    {name:'Plain Yogurt Flatccino', price:4200, picture:'menu/f1.jpg'},
    {name:'Blueberry Yogurt Flatccino', price:4200, picture:'menu/f2.jpg'},
    {name:'Strawberry Yogurt Flatccino', price:4200, picture:'menu/f3.jpg'},
    {name:'Mango Flatccino', price:3500, picture:'menu/f4.jpg'},
    {name:'Green Tea Flatccino', price:4200, picture:'menu/f5.jpg'},
    {name:'Grapefruit Flatccino', price:3800, picture:'menu/f6.jpg'},
  ]
  const menus_dessert = [
    {name:'Souffle Cheese Cake', price:3900, picture:'menu/d1.jpg'},
    {name:'Devil\'s Choco Cake', price:3900, picture:'menu/d2.jpg'},
    {name:'Choco Tiramisu', price:3900, picture:'menu/d3.jpg'},
    {name:'Honey Caramel Bread', price:4600, picture:'menu/d4.jpg'},
    {name:'Maple Nut Bread', price:4800, picture:'menu/d5.jpg'},
    {name:'Croissant', price:2300, picture:'menu/d6.jpg'},
  ]

  const menuList = document.querySelector(".coffee") // menuList 변수에 class가 .menuList인 태그 주소를 넣는다.
  let str = '' //값을 유지하기 위해 전역변수 선언
  for (let i = 0; i < menus_coffee.length; i++) {
    const menu = menus_coffee[i]
    str += `  <div class="col">
                <div coffee-idx="${i}">
                  <img src = "${menu.picture}">
                  <div class="card-body">
                    <div>${menu.name}</div>
                    <div>${menu.price}</div>
                  </div>
                </div>
              </div>`

  }
  menuList.innerHTML = str

  menuList.addEventListener("click", (e)=> {
    e.preventDefault()
    e.stopPropagation()

    const target = e.target
    const divEle = target.closest("div")
    const idx = divEle.getAttribute("coffee-idx")
    const menu = menus_coffee[idx]


    bill(menu)
    showOrderItems()


  }, false)

  const menuList2 = document.querySelector(".flatccino") // menuList 변수에 class가 .menuList인 태그 주소를 넣는다.
  let str2 = '' //값을 유지하기 위해 전역변수 선언
  for (let i = 0; i < menus_flatccino.length; i++) {
    const menu = menus_flatccino[i]
    str2 += `  <div class="col">
                <div flatccino-idx="${i}">
                  <img src = "${menu.picture}">
                  <div class="card-body">
                    <div>${menu.name}</div>
                    <div>${menu.price}</div>
                  </div>
                </div>
              </div>`

  }
  menuList2.innerHTML = str2


  menuList2.addEventListener("click", (e)=> {
    e.preventDefault()
    e.stopPropagation()

    const target = e.target
    const divEle = target.closest("div")
    const idx = divEle.getAttribute("flatccino-idx")
    const menu = menus_flatccino[idx]


    bill(menu)
    showOrderItems()


  }, false)

  const menuList3 = document.querySelector(".dessert") // menuList 변수에 class가 .menuList인 태그 주소를 넣는다.
  let str3 = '' //값을 유지하기 위해 전역변수 선언
  for (let i = 0; i < menus_flatccino.length; i++) {
    const menu = menus_dessert[i]
    str3 += `  <div class="col">
                <div dessert-idx="${i}">
                  <img src = "${menu.picture}">
                  <div class="card-body">
                    <div>${menu.name}</div>
                    <div>${menu.price}</div>
                  </div>
                </div>
              </div>`

  }
  menuList3.innerHTML = str3


  menuList2.addEventListener("click", (e)=> {
    e.preventDefault()
    e.stopPropagation()

    const target = e.target
    const divEle = target.closest("div")
    const idx = divEle.getAttribute("flatccino-idx")
    const menu = menus_flatccino[idx]


    bill(menu)
    showOrderItems()


  }, false)
  function bill(menu){
    // 이 경우만 남긴 후 result에 저장
    const result = orders.filter(oi => oi.name === menu.name)

    console.log("-------check result-----------")
    console.log(result)
    // result는 리모콘이므로 result[0]은 곧 중복값이 있던 orders[아무개]가 됨
    if(result.length > 0){
      result[0].qty += 1

    }else {
      orders.push({...menu, qty:1})
    }

    console.log(orders)
    showOrderItems()
  }



  function showOrderItems() {
    const orderListEle = document.querySelector(".orderlist")
    let str = ''
    let sum = 0
    for (let i = 0; i < orders.length; i++) {
      const orderItem = orders[i]

      str += `<ol class="list-group list-group-numbered">
  <li class="list-group-item d-flex justify-content-between align-items-start">
    <div class="ms-2 me-auto">
      <div class="fw-bold">${orderItem.name}</div>
      ${orderItem.price}
    </div>
    <span class="badge bg-primary rounded-pill">${orderItem.qty}</span>
  </li>
</ol>`
      sum += orderItem.price * orderItem.qty
    }
    str += `<ul class="list-group list-group-flush" style="float:right">
  <li class="list-group-item">총계 : ${sum}</li>`
    orderListEle.innerHTML = str
  }
  function reset(){
    const orderListEle = document.querySelector(".orderList")
    orderListEle.innerHTML = ''
    orders = []
  }



</script>
</body>
</html>